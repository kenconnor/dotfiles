FROM ubuntu:22.04 AS build-env
#RUN ln -sf /usr/share
RUN apt update \
 && apt install -y curl
RUN curl -OL https://github.com/neovim/neovim/releases/download/v0.10.1/nvim.appimage
RUN chmod u+x nvim.appimage && ./nvim.appimage  --appimage-extract

FROM osrf/ros:humble-desktop
COPY --from=build-env /squashfs-root /root/nvim-0.10.1
RUN ln -s /root/nvim-0.10.1/AppRun /usr/bin/nvim
RUN apt-get update && apt-get install --no-install-recommends -y \
    git \
    curl \
    clangd \
 && apt-get clean \
 && rm -rf /var/lib/apt/lists/*
RUN curl -sL install-node.vercel.app/lts | bash -s -- -y
RUN mkdir -p /root/.local/share
#RUN cd $HOME && sh -c "$(curl -fsSL https://raw.githubusercontent.com/Shougo/dein-installer.vim/master/installer.sh)" --overwrite-config ./.local/share/dein --use-neovim-config
COPY .vim/dein/dein.toml /root/.config/nvim/dein.toml
COPY .vim/coc-settings.json /root/.config/nvim/coc-settings.json
COPY .config/nvim/init.lua /root/.config/nvim/init.lua

